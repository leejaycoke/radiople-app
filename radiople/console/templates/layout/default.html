<!DOCTYPE html>
<html lang="ko" ng-app="RadiopleApplication">
{% include 'dist/head.html' %}
<script>
app.controller('BaseController', function($scope, requestService, $httpParamSerializerJQLike) {
    $scope.broadcasts = [
        {% for broadcast in session.broadcasts %}
        {'id': {{ broadcast.id }}, 'title': '{{ broadcast.title|safe }}'},
        {% endfor %}
    ];

    $scope.selectedBroadcastId = {{ session.broadcast_id }};

    $scope.broadcastChanged = function() {
        requestService.put('/auth/current-broadcast', {'broadcast_id': $scope.selectedBroadcastId}, {
            success: function(response) {
                location.reload();
            },
            error: function(error) {

            }
        })
    }
});
</script>

<body ng-controller="BaseController">
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle rec" ng-click="navCollapsed = !navCollapsed">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Radiople</a>
            </div>
        </div>
    </nav>
    <div class="container-fluid content-wrapper">
        <div class="row content">
            <div class="col-sm-3 col-md-2 sidebar hidden-xs">
                <div id="broadcast-pannel">
                    <select class="form-control" ng-options="b.id as b.title for b in broadcasts" ng-model="selectedBroadcastId" ng-change="broadcastChanged();">
                    </select>
                </div>
                <ul class="nav nav-sidebar">
                    <li><a href="{{ url_for('bp_dashboard.index_html') }}"><i class="glyphicon glyphicon-dashboard"></i> 대시보드 <span class="sr-only">(current)</span></a></li>
                    <li><a href="{{ url_for('bp_broadcast.edit_html') }}"><i class="glyphicon glyphicon-equalizer"></i> 방송 관리</a></li>
                    <li><a href="{{ url_for('bp_episode.list_html') }}"><i class="glyphicon glyphicon-headphones"></i> 에피소드</a></li>
                    <li><a href="{{ url_for('bp_auth.signout') }}"><i class="glyphicon glyphicon-lock"></i> 로그아웃</a></li>
                </ul>
            </div>
            <div class="col-md-10 col-sm-9 col-md-offset-2 col-sm-offset-3 main">
                {% block body %} {% endblock %}
            </div>
        </div>
    </div>
</body>

</html>
